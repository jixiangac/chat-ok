# Design: 多问题队列追问组件

## Context

FollowupQuestion 组件是 Agent Chat 中用于展示 AI 追问选项的 UI 组件。当前实现仅支持单个问题，用户点击后立即回调。新需求要求支持多问题场景，形成类似表单的交互体验。

## Goals / Non-Goals

**Goals**
- 支持多问题垂直列表展示
- 提供清晰的进度指示和选中状态反馈
- 统一提交所有答案，提交前可修改
- 单题场景保持现有简洁体验

**Non-Goals**
- 不支持问题之间的条件跳转逻辑
- 不支持必答/选答区分
- 不添加自定义输入功能

---

## UI 设计规范

### 设计风格

延续项目 **Notion 风格 + Soft UI Evolution** 设计语言：
- 浅系简约，大量留白
- 极少使用阴影，主要依靠边框和背景色区分层级
- 圆角柔和，交互轻盈

### 配色系统

| 用途 | 色值 | 说明 |
|------|------|------|
| 组件背景 | `rgba(255, 255, 255, 0.95)` | 半透明白底，带毛玻璃效果 |
| 问题卡片背景 | `transparent` | 无背景，与容器融合 |
| 选项默认背景 | `transparent` | 透明 |
| 选项选中背景 | `linear-gradient(135deg, #F1F1E8 0%, #E8F0E8 100%)` | 今日毕高亮色系 |
| 选项 hover 背景 | `rgba(55, 53, 47, 0.02)` | 极淡灰 |
| 边框色 | `rgba(55, 53, 47, 0.06)` | 淡分割线 |
| 主文字 | `rgb(55, 53, 47)` | Notion 主文字色 |
| 次要文字 | `rgba(55, 53, 47, 0.5)` | 问题标题、进度指示 |
| 序号文字 | `rgba(55, 53, 47, 0.35)` | 选项序号 |
| 禁用状态 | `opacity: 0.45` | 已提交或禁用时 |

### 圆角规范

| 元素 | 圆角 |
|------|------|
| 组件容器 | `16px` |
| 选项按钮 | `8px` |
| 确认按钮 | `12px` |
| 序号徽章 | `6px` |

### 间距规范

| 位置 | 间距 |
|------|------|
| 组件外边距 | `12px 16px` |
| 组件内边距 | `14px 16px` |
| 问题间距 | `16px` |
| 选项间距 | `0`（使用分割线） |
| 选项内边距 | `14px 16px` |

### 字体规范

| 元素 | 字号 | 字重 | 行高 |
|------|------|------|------|
| 问题标题 | `14px` | `500` | `1.4` |
| 选项文字 | `15px` | `400` | `1.4` |
| 序号文字 | `12px` | `500` | `1` |
| 进度指示 | `12px` | `400` | `1` |
| 确认按钮 | `15px` | `500` | `1` |

---

### 整体布局

```
┌─────────────────────────────────────────────┐
│                                   1 / 3     │  ← 进度指示：右上角，次要文字色
├─────────────────────────────────────────────┤
│                                             │
│  问题1：你希望这个任务是什么类型？            │  ← 问题标题：次要文字色
│  ┌─────────────────────────────────────┐    │
│  │  A   数值型目标                      │    │  ← 选项：主文字色
│  ├─────────────────────────────────────┤    │  ← 分割线：边框色
│  │  B   清单型目标          ✓ 选中高亮  │    │  ← 选中：今日毕渐变背景
│  ├─────────────────────────────────────┤    │
│  │  C   打卡型目标                      │    │
│  └─────────────────────────────────────┘    │
│                                             │
│  问题2：你计划多少天完成？                   │
│  ┌─────────────────────────────────────┐    │
│  │  A   7天                             │    │
│  ├─────────────────────────────────────┤    │
│  │  B   21天                            │    │
│  ├─────────────────────────────────────┤    │
│  │  C   30天                            │    │
│  └─────────────────────────────────────┘    │
│                                             │
├─────────────────────────────────────────────┤
│              [ 确认提交 ]                   │  ← 底部固定，答完才可用
└─────────────────────────────────────────────┘
```

---

### 组件状态

| 状态 | 视觉表现 |
|------|----------|
| 未答问题 | 所有选项正常显示，无背景高亮 |
| 已答问题 | 保留所有选项，选中项使用今日毕渐变背景 |
| 当前问题 | 自动滚动定位到视口，与已答无视觉区分 |
| 已提交 | 整体 `opacity: 0.45`，`pointer-events: none` |

### 选中样式（核心）

采用项目统一的 **Soft UI Evolution** 高亮风格：

```css
/* 选中状态 - 今日毕色系 */
.optionSelected {
  background: linear-gradient(135deg, #F1F1E8 0%, #E8F0E8 100%);
  border-radius: 8px;
}

/* 序号徽章 - 选中时加深 */
.badgeSelected {
  background: linear-gradient(135deg, #B9C9B9 0%, #A8B8A8 100%);
  color: rgb(55, 53, 47);
}
```

不使用勾选图标，仅通过背景色区分选中状态，保持简约。

### 序号徽章

| 状态 | 样式 |
|------|------|
| 默认 | 背景 `rgba(55, 53, 47, 0.06)`，文字 `rgba(55, 53, 47, 0.5)` |
| 选中 | 背景 `linear-gradient(135deg, #B9C9B9, #A8B8A8)`，文字 `rgb(55, 53, 47)` |

序号使用字母 A、B、C、D（不带方括号），放在小圆角徽章内，尺寸 `20px × 20px`。

### 进度指示

- 位置：组件右上角，与第一个问题标题同行
- 格式：`1 / 3`
- 样式：`font-size: 12px`，`color: rgba(55, 53, 47, 0.5)`

### 确认按钮

| 状态 | 样式 |
|------|------|
| 禁用 | 背景 `rgba(55, 53, 47, 0.06)`，文字 `rgba(55, 53, 47, 0.35)` |
| 可用 | 背景 `rgb(55, 53, 47)`，文字 `#FFFFFF` |
| hover | `opacity: 0.85`，过渡 `0.2s` |
| active | `transform: scale(0.98)` |

按钮高度 `44px`，圆角 `12px`，宽度撑满（两侧留 `16px` 边距）。

---

### 动画规范

| 交互 | 动画 |
|------|------|
| 选项 hover | `background-color 0.15s ease` |
| 选项点击 | `transform: scale(0.98)` + 背景切换 |
| 滚动到下一题 | `scrollIntoView({ behavior: 'smooth', block: 'start' })` |
| 按钮状态切换 | `opacity 0.2s ease`，`background-color 0.2s ease` |

遵循项目动画规范：过渡时间 `0.15s-0.2s`，缓动函数 `ease` / `ease-out`。

---

## Decisions

**决策1: 单题保持现有样式**

当 `questions.length === 1` 时，保持现有的简化展示，不显示进度指示和确认按钮，点击选项后直接回调。这样避免简单场景过于复杂。

**决策2: 垂直滚动而非横向轮播**

选择垂直列表滚动方式，因为：
- 用户可以看到所有问题全貌，更有掌控感
- 支持提前查看和跳回修改
- 交互更直观，符合表单习惯

**决策3: 移除自定义输入**

根据需求，多问题场景不需要自定义输入功能，简化组件复杂度。

**决策4: 采用今日毕高亮色系**

选中状态使用项目统一的 `#F1F1E8 → #E8F0E8` 渐变背景，与设置面板、修炼面板等组件保持视觉一致性。

---

## Risks / Trade-offs

**问题数量过多**
- 风险：超过 5-7 个问题时，用户体验可能下降
- 缓解：设置最大高度 `50vh` + 内部滚动，确保组件不会撑开父容器

**滚动定位准确性**
- 风险：不同问题高度不一致可能导致滚动定位不准
- 缓解：使用 `scrollIntoView({ behavior: 'smooth', block: 'start' })` API 自动对齐

---

## Open Questions

- 是否需要支持问题之间的条件跳转？（当前设计不支持）
- 是否需要支持 `prefers-reduced-motion` 减弱动画？（建议后续补充）
