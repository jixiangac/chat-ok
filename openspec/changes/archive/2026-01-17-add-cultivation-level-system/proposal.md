# Change: 添加修仙等级体系

## Why

当前任务管理系统缺乏长期激励机制，用户容易在完成短期目标后失去动力。引入基于《凡人修仙传》的修仙等级体系，将任务完成与"修为"挂钩，通过境界晋升、闭关保护等游戏化元素，提升用户粘性和持续完成任务的积极性。

## What Changes

### 新增功能

- **修仙等级体系**: 9 大境界，共 53 个等级
  - 炼气期（13 层）
  - 筑基期 ~ 渡劫期（各 5 阶段：初期/中期/后期/巅峰/大圆满）

- **修为获取机制**:
  - 日常打卡实时获得修为（不同任务类型配置不同值）
  - 周期结算奖励（完成度 ≥30% 触发，100% 完成 +20% 加成）

- **修为降低机制**:
  - 周期完成度 <30% 扣除固定修为值
  - 境界越低扣得越少，保底不负数

- **境界晋升**: 修为满后手动点击"突破"晋升

- **境界降级保护**:
  - 小阶段降级：直接降级
  - 跨大境界降级：触发 15 天闭关保护期，完成维持目标可保级

- **修炼面板 UI**: 主页下拉触发全屏修炼界面，展示境界、修为进度、角色形象

- **修为历史记录**: 按周存储修为变动明细

### 后续实现（本提案不含）

- 灵石系统与折扣特权
- 邪修途径（广告）
- 晋升/降级动画弹窗

## Impact

- **Affected specs**: 新增 `cultivation-system` 能力规范
- **Affected code**:
  - `src/pages/dc/contexts/` - 新增 CultivationContext
  - `src/pages/dc/panels/` - 新增修炼面板
  - `src/pages/dc/utils/` - 修为计算工具
  - `src/pages/dc/types.ts` - 新增修仙相关类型
  - 任务打卡逻辑 - 接入修为获取
