# normal-panel Specification

## Purpose
常规面板（Normal Panel）是目标管理系统的核心视图，提供主线任务和支线任务的管理功能，包括任务创建、编辑、标签分类、今日必须完成任务设置等功能。

## Requirements
### Requirement: 支线任务网格响应式显示

系统 **SHALL** 根据屏幕高度动态计算支线任务的显示数量。

#### Scenario: 小屏幕设备显示较少任务

**GIVEN** 用户在小屏幕移动设备上访问常规面板
**WHEN** 系统计算可用屏幕高度
**THEN** 支线任务网格显示适合屏幕高度的任务数量（最少1行2个，最多3行6个）

#### Scenario: 大屏幕设备显示更多任务

**GIVEN** 用户在大屏幕设备上访问常规面板
**WHEN** 系统计算可用屏幕高度
**THEN** 支线任务网格显示最多3行6个任务

#### Scenario: 保留现有查看更多方式

**GIVEN** 支线任务总数超过显示数量
**WHEN** 用户需要查看所有任务
**THEN** 可以通过"所有支线"按钮查看完整列表

---

### Requirement: 创建任务弹窗移动端适配

系统 **SHALL** 确保创建任务弹窗在移动端正确显示，无横向滚动条。

#### Scenario: 弹窗内容适配小屏幕

**GIVEN** 用户在移动设备上打开创建任务弹窗
**WHEN** 弹窗显示任何步骤的内容
**THEN** 所有内容在屏幕宽度内正确显示，无横向滚动条

#### Scenario: 周期设定步骤响应式布局

**GIVEN** 用户在创建任务弹窗的周期设定步骤
**WHEN** 屏幕宽度小于375px
**THEN** 总时长选项使用单列布局

#### Scenario: 类型选择步骤响应式布局

**GIVEN** 用户在创建任务弹窗的类型选择步骤
**WHEN** 在移动设备上显示
**THEN** 任务类型卡片垂直排列，内容完整显示

#### Scenario: 配置步骤响应式布局

**GIVEN** 用户在创建任务弹窗的配置步骤
**WHEN** 屏幕宽度小于375px
**THEN** 表单输入框和按钮使用响应式布局，避免横向溢出

#### Scenario: 打卡类型选择响应式布局

**GIVEN** 用户在打卡型任务配置中选择打卡类型
**WHEN** 屏幕宽度小于375px
**THEN** 3列网格自动调整为2列或单列布局

---

### Requirement: 页面切换动画

系统 **SHALL** 为常规面板的交互提供流畅的动画效果。

#### Scenario: 弹窗打开动画

**GIVEN** 用户点击创建任务按钮
**WHEN** 弹窗开始显示
**THEN** 弹窗从底部滑入，带有淡入效果，使用弹簧物理动画

#### Scenario: 弹窗关闭动画

**GIVEN** 用户关闭创建任务弹窗
**WHEN** 弹窗开始隐藏
**THEN** 弹窗向底部滑出，带有淡出效果

#### Scenario: 步骤切换动画

**GIVEN** 用户在创建任务弹窗中切换步骤
**WHEN** 点击"下一步"或"上一步"
**THEN** 当前步骤淡出并滑出，新步骤淡入并滑入，方向与导航方向一致

#### Scenario: 任务卡片交互动画

**GIVEN** 用户与任务卡片交互
**WHEN** 悬停或点击任务卡片
**THEN** 卡片有轻微的缩放和阴影变化动画

#### Scenario: 支线任务网格进入动画

**GIVEN** 支线任务网格首次加载
**WHEN** 任务卡片显示
**THEN** 卡片依次淡入并从下方滑入，有轻微的延迟错开效果

---

### Requirement: 动画性能优化

系统 **SHALL** 确保动画在移动设备上流畅运行。

#### Scenario: 使用GPU加速

**GIVEN** 系统实现动画效果
**WHEN** 动画执行
**THEN** 仅使用 transform 和 opacity 属性，触发 GPU 加速

#### Scenario: 避免布局抖动

**GIVEN** 动画正在执行
**WHEN** 元素位置或大小变化
**THEN** 不触发页面重排，保持布局稳定

#### Scenario: 低端设备动画降级

**GIVEN** 用户在低端移动设备上访问
**WHEN** 系统检测到性能限制
**THEN** 简化动画效果或使用 prefers-reduced-motion 媒体查询

---

### Requirement: 移动端触摸优化

系统 **SHALL** 优化移动端的触摸交互体验。

#### Scenario: 按钮触摸区域

**GIVEN** 用户在移动设备上操作
**WHEN** 点击按钮或交互元素
**THEN** 触摸区域至少为 44x44px，符合移动端可访问性标准

#### Scenario: 表单输入优化

**GIVEN** 用户在移动设备上填写表单
**WHEN** 聚焦输入框
**THEN** 输入框有明显的焦点状态，键盘弹出不遮挡内容

#### Scenario: 抽屉手势优化

**GIVEN** 用户打开支线任务抽屉
**WHEN** 在移动设备上操作
**THEN** 抽屉支持下滑关闭手势，动画流畅自然

---

### Requirement: 响应式间距和字体

系统 **SHALL** 根据屏幕尺寸调整间距和字体大小。

#### Scenario: 小屏幕间距调整

**GIVEN** 用户在小屏幕设备上访问
**WHEN** 显示常规面板内容
**THEN** 内边距和间距适当减小，保持内容可读性

#### Scenario: 字体大小适配

**GIVEN** 用户在移动设备上访问
**WHEN** 显示文本内容
**THEN** 字体大小在小屏幕上保持可读（最小12px）

#### Scenario: 弹窗内边距适配

**GIVEN** 创建任务弹窗在移动设备上显示
**WHEN** 屏幕宽度小于375px
**THEN** 弹窗内边距从24px减小到16px

---

### Requirement: 今日必须完成任务功能

系统 **SHALL** 支持用户每日设置当天必须完成的支线任务。

#### Scenario: 每日自动弹出设置弹窗

**GIVEN** 用户在8点后首次打开应用
**WHEN** 当天尚未设置今日必须完成任务
**THEN** 系统自动弹出今日必须完成任务设置弹窗

#### Scenario: 任务选择限制

**GIVEN** 用户在设置今日必须完成任务
**WHEN** 选择任务
**THEN** 最多可选择3个任务

#### Scenario: 跳过设置

**GIVEN** 用户在今日必须完成设置弹窗
**WHEN** 点击跳过按钮
**THEN** 当天不再自动弹出设置弹窗

#### Scenario: 今日必须完成任务置顶显示

**GIVEN** 用户已设置今日必须完成任务
**WHEN** 查看支线任务列表
**THEN** 今日必须完成任务置顶显示，并有特殊视觉标识

#### Scenario: 跨天自动重置

**GIVEN** 用户已设置今日必须完成任务
**WHEN** 第二天打开应用
**THEN** 前一天的今日必须完成状态自动清除

#### Scenario: 设置面板入口

**GIVEN** 当天尚未设置今日必须完成任务
**WHEN** 用户打开设置面板
**THEN** 显示"设置今日必须完成任务"入口

---

### Requirement: 支线任务标签功能

系统 **SHALL** 支持为支线任务添加标签进行分类管理。

#### Scenario: 创建标签

**GIVEN** 用户在编辑任务或创建任务时
**WHEN** 需要添加新标签
**THEN** 可以创建新标签，系统自动分配颜色

#### Scenario: 选择已有标签

**GIVEN** 用户在编辑任务
**WHEN** 选择标签
**THEN** 可以从已有标签列表中选择

#### Scenario: 单标签限制

**GIVEN** 用户为任务设置标签
**WHEN** 选择标签
**THEN** 每个任务只能设置1个标签

#### Scenario: 标签颜色自动分配

**GIVEN** 用户创建新标签
**WHEN** 标签创建成功
**THEN** 系统自动从预设颜色中分配一个颜色

---

### Requirement: 支线任务编辑功能

系统 **SHALL** 支持编辑已创建的支线任务。

#### Scenario: 编辑入口

**GIVEN** 用户在任务详情页
**WHEN** 点击编辑按钮
**THEN** 打开任务编辑弹窗

#### Scenario: 编辑任务名称

**GIVEN** 用户在编辑弹窗中
**WHEN** 修改任务名称并保存
**THEN** 任务名称更新成功

#### Scenario: 编辑任务标签

**GIVEN** 用户在编辑弹窗中
**WHEN** 修改任务标签并保存
**THEN** 任务标签更新成功

---

### Requirement: Group 模式视图

系统 **SHALL** 支持按标签分组显示支线任务。

#### Scenario: 模式切换入口

**GIVEN** 存在带标签的支线任务
**WHEN** 用户查看支线任务区域
**THEN** 显示模式切换图标

#### Scenario: 无标签时隐藏切换

**GIVEN** 所有支线任务都没有标签
**WHEN** 用户查看支线任务区域
**THEN** 不显示模式切换图标

#### Scenario: Group 卡片显示

**GIVEN** 用户切换到 Group 模式
**WHEN** 查看支线任务区域
**THEN** 显示按标签分组的卡片，每个卡片显示标签名、进度和图标

#### Scenario: Group 详情弹窗

**GIVEN** 用户在 Group 模式下
**WHEN** 点击某个标签卡片
**THEN** 弹出该标签下所有任务的网格视图

---

### Requirement: 滚动条优化

系统 **SHALL** 确保滚动条只在 Tab 内容区域显示。

#### Scenario: Tab 内容区域滚动

**GIVEN** 用户在常规面板查看内容
**WHEN** 内容超出可视区域
**THEN** 滚动条只出现在 Tab 对应的内容区域，不影响其他区域

#### Scenario: 多滚动条避免

**GIVEN** 页面包含多个可滚动区域
**WHEN** 用户滚动页面
**THEN** 不会出现多个滚动条同时显示的情况

---
